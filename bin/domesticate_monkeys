
# require context
require 'optparse'
require 'domesticate_monkeys'
require 'pry'

# set variables
main_app = DomesticateMonkeys::MainApp
options  = {}

# parse task options
OptionParser.new do |parser|
  
  parser.banner = <<~BANNER
    
    domesticate_monkeys shows you all the method redefinitions within your application and its gems.

    Options:
  BANNER

  parser.on("-s [SHOW]", "--show [SHOW]", "show view [app, all]") { |view| options[:view] = view }
  parser.on("-h", "--help", "show option") { puts parser; exit }
  parser.on("-v", "--version", "show version") { puts DomesticateMonkeys::VERSION; exit }
end.parse!

# set default arguments
options[:view] = options[:view] || :app

# validate task
abort "Aborted: invalid view argument" unless %i( app all ).include?(options[:view]&.to_sym)
abort "Aborted: too many arguments"    unless ARGV.empty?

# load application
load main_app

# print results
view = DomesticateMonkeys::View.new
view.send(options[:view])